---
title: "[25/07/25] - 클라우드 보안 (5일차)"
date: 2025-07-25 00:00:00 +0900
categories: ['SK 루키즈 교육','클라우드 보안']
tags: ['교육']
---

<!--more-->



---

# ▪︎ 데이터베이스 서버

## ▫︎  DBMS

- 엔진 : MySQL, PostgreSQL, MariaDB, Amazon Aurora

## ▫︎  RDS

- Amazon RDS 기능
    - 관계형 데이터베이스의 관리형 서비스(관리형 DB)
- Multi-AZ
    - 프라이머리 인스턴스 & 예비 복제몬(Standby replica)를 다중 AZ에 배포 : 장애 조치 통한 고가용성
- 읽기 전용 복제본
    - 프라이머리 인스턴스에서 복제된 읽기 전용 인스턴스
    - 읽기가 많은 경우 읽기 전용 복제본으로 읽기 부하 분산
- RDS 접근 제어
    - NACL과 Security group을 이용 접근제어
- RDS 데이터베이스 백업
    - 자동 백업(보존기간 0~35일) : 지정한 일 수 만큼의 스냅샷 자동 유지
        - 0 은 자동백업 비활성화
        - 첫번째 전체 스냅샷 이후 후속 스냅샷은 증분식(변경분만 저장)
    - 수동 백업 : 수동 스냅샷 생성(35일 이상 백업 보존)
    - 특정 시점 복원(PITR, Point in Time Recovery) : 특정 시간을 지정하여 복원(최소 5분전, 보전 기간 내)
- RDS 구성
    
![image_01](/assets/img/sk_shieldus_26/250725_image_01.png)
    

[Amazon RDS를 사용하여 MySQL 데이터베이스 생성 및 연결](https://aws.amazon.com/ko/getting-started/hands-on/create-mysql-db/)

# ▪︎ AWS 실습

## ▫︎  EC2 > 보안그룹

- 보안 그룹 생성
- 보안 그룹 이름 : sgdb
- 설명 : sg for db
- VPC : MyVPC
- 인바운드 규칙
    - 유형 : MySQL/Aurora
    - 소스 : Anywhere-Ipv4
- 보안 그룹 생성

## ▫︎  RDS > 서브넷 그룹

- DB 서브넷 그룹 생성
    - 이름 : mydbsubnetgrp01
    - 설명 : subnet group for rds
    - VPC : MyVPC 선택
    - 가용 영역 : `ap-northeast-2a`, ap-northeast-2c 선택
    - 서브넷 : MyPubSubnet2, MyPubSubnet 선택

## ▫︎  RDS

- 데이터베이스 생성 클릭
- MySQL 선택
- 엔진 버전 : MySQL 8.0.42(짝수)
- 템플릿 : 프리 티어 선택
- 인스턴스 식별자 : myrdskbk01
- db 관리자 유저/PW : -/-
- 스토리지
    - 20G
    - 추가 스토리지 조정
    - 스토리지 자동 조정 비활성화
- 인스턴스 : db.t3.micro
- DB VPC : MyVPC
- DB 서브넷 그룹
    - 이름 : mydbsubnetgrp01
    - 퍼블릭 액세스 : 예
- 기본 VPC 보안그룹 : sgdb만 선택(default 해제)
- 추가구성
    - 초기 db 이름 : mydbkbk01

<aside>
💡

**DB 생성시 오류**

![image_02](/assets/img/sk_shieldus_26/250725_image_02.png)

- VPC → MyVPC → 작업:VPC 설정 편집 클릭
- DNS 설정 → ‘DNS 호스트 이름 활성화’ 클릭 후 저장
</aside>

**➡ DB 생성**

![image_03](/assets/img/sk_shieldus_26/250725_image_03.png)

# ▪︎ MySQL 쿼리

## ▫︎  MySQL 다운

[MySQL :: Download MySQL Workbench](https://dev.mysql.com/downloads/workbench/)

- Database > Connect to Database 클릭
- Hostname : AWS RDS에 엔드포인트 복사해서 입력
- Username : 설정한 dbadmin 입력

![image_04](/assets/img/sk_shieldus_26/250725_image_04.png)

## ▫︎  Database 생성

```bash
create database db001;

use db001;

CREATE TABLE tbl01
(
	empno INT NOT NULL PRIMARY KEY,
    ename VARCHAR(10)
);

select * from tbl01;
```

## ▫︎  DB 데이터 추가

- 아무 데이터나 입력
    
![image_05](/assets/img/sk_shieldus_26/250725_image_05.png)
    

## ▫︎  DB 삭제

- 데이터베이스 → 작업:삭제
- ‘최종 스냅샷 생성’, ‘자동 백업 보존’ 체크 해제
    - `인스턴스 삭제 시 시스템 스냅샷 및 특정 시점으로 복구를 포함한 자동화된 백업을 더 이상 사용할 수 없다는 점을 인정합니다.` 체크
- 이후 삭제 가능

# ▪︎ DynamoDB

- 키-값 데이터 유형의 비관계형(NoSQL) DB
- 단순 데이터 구조: 복잡한 검색보다 고속 데이터 검색
- 스키마 유연성 높음
- 완전 관리형 서비스, 서버리스

## ▫︎  기능 및 특징

- 일관된 선은 : 00ms 미만의 성능
- 무제한 처리량
- 서버 관리 불필요 : 테이블과 기본 키(파티션 키, 정렬키-optional) 생성 후 즉시 사용
- 사례
    - 수백만 사용자 및 추당 수백만 건의 요청 처리
    - 모바일 게임 순위표, 장바구니 및 고객 프로필
- DynamoDB 가용성 : 데이터 중복 저장
    - 3개의 AZ에 데이터 복제
- 백업
    - 자동 백업으로 특정 시점 복원 가능
    - 수동 백업 지원

<aside>
💡

RDS → AZ 레벨 / DynamoDB → 리전 레벨 

</aside>

# ▪︎ AWS 실습

## ▫︎  DynamoDB

- 테이블 생성
    - 테이블 이름 : mytbl01
    - 파티션 키 : id
- 항목 탐색 → 항목 생성
    - id : 1 추가
    - id : 2, name : tom, addr:seoul 추가(전부 문자열)
    - id : 3, name : yena, class:A 추가(전부 문자열)
    
![image_06](/assets/img/sk_shieldus_26/250725_image_06.png)
    
- 쿼리 → 속성 : id, 파티션 키 : 2인 항목 검색

# ▪︎ AWS Lambda

- Lambda :: AWS 서버리스 애플리케이션
    - 애플리케이션 실행을 위한 서버 인프라 생성, 관리할 필요없이 간편하게 애플리케이션 생성 실행
    - 지원 SDK : Python, Java, .NET, Node.js, Go, Ruby
    - S3, dynamoDB 같은 것들이 lambda

## ▫︎  특징

- 권한
    - 실행 역할, 정책
- 메모리 구성 : 128~10240M
- 시간 제한 : 1초 ~ 15분
- 실행 시에만 요금 부과

# ▪︎ AWS Lambda

[자습서: Amazon S3 트리거를 사용하여 썸네일 이미지 생성 - AWS Lambda](https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/with-s3-tutorial.html)

- python 3.9버전으로 사용

## ▫︎  순서

- s3 버킷 생성(buc, buc-resized)
- IAM > 정책 생성 → JSON 복사 붙여넣기
    - **LambdaS3PolicyKBK**
- IAM > 역할 생성
    - 서비스
    - 사용 사례 : Lambda
    - 권한 정책 : 위에서 만든 **LambdaS3PolicyKBK**
    - 역할 이름 : LambdaS3RoleKBK
- Lambda > 함수생성
    - 런타임 : Python 3.9
    - 실행 역할 : 기존 역할 사용
        - LambdaS3RoleKBK 선택
- Lambda 함수(CreateThumbnail) > 소스 코드 > 에서 업로드 : .zip 파일 > lambda_function.zip 파일 업로드
- Lambda 함수(CreateThumbnail) > 트리거 추가
    - 소스 : S3
    - 버켓 : 생성한거(리사이즈X)
    - 이벤트 유형: 모든 객체 생성 이벤트
    - 재귀 호출
        - 잘못해서 계속해서 호출하면 비용 상승하는거 알고 있는지 확인
    
![image_07](/assets/img/sk_shieldus_26/250725_image_07.png)
    

## ▫︎  테스트

- S3 버킷(**kbkbuc0101)** 에 이미지 업로드
- resized 버킷에 이미지 업로드 된 거 확인

# ▪︎ VP와 다른 네트워크 연결

## ▫︎  VPN

- AWS VPN
    - AWS 클라우드와 온프레미스 사이에 보안 연결
- AWS Direct Connect
    - AWS 클라우드와 온프레미스 사이에 네트워크 전용선 연결

## ▫︎  VPC 피어링

- VPC와 VPC 간에 사설 네트워크 연결
- IGW를 거치지 않고 피어링 전용 GW 사용
- 제약
    - 전이적 연결 불가
    - 중복된 CIDR 주소 연결 불가
    
![image_08](/assets/img/sk_shieldus_26/250725_image_08.png)
    

## ▫︎  Transit 게이트웨이

- 다수의 네트워크들을 허브 앤 스포크 형식으로 사설 연결

![image_09](/assets/img/sk_shieldus_26/250725_image_09.png)

## ▫︎  삭제

버킷 객체 비우고 버킷 삭제 → Lambda 함수 삭제

- Role은 지우지 않음